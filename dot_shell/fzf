! command -v fzf >/dev/null 2>&1 && return

case "$-" in
    *i*) ;;
    *) return ;;
esac

fzfopen() {
    "$@" | fzf --tac --bind "enter:execute(printf '%q' {} | xargs nvim </dev/tty)"
}

fzf-combined() {
    fzf --preview 'cat -n {}' \
        --bind 'ctrl-v:become(vim {})' \
        --bind 'ctrl-o:execute(printf "%s" {} | jq -sRr @uri | xargs -I uri open "obsidian://open?path=uri")' \
        --bind 'ctrl-c:execute(printf "%s" {} | pbcopy)+abort'
}
